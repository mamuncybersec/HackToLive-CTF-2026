<?php session_start();
$challenges = [
    ['id' => 1, 'title' => 'Disassembly Basics', 'description' => 'Identify the function', 'encrypted' => 'main: push rbp; mov rbp,rsp; call calculate; leave; ret', 'answer' => 'main calls calculate', 'hint' => 'Read from top to bottom', 'difficulty' => 'Easy', 'points' => 50],
    ['id' => 2, 'title' => 'Identify String', 'description' => 'What string is referenced?', 'encrypted' => 'lea rax,[rel message]; mov rdi,rax; call puts', 'answer' => 'message', 'hint' => 'Look for string labels', 'difficulty' => 'Medium', 'points' => 75],
    ['id' => 3, 'title' => 'Algorithm Recognition', 'description' => 'What algorithm?', 'encrypted' => 'loop: cmp eax,1; jle end; sub eax,1; mul result; jmp loop', 'answer' => 'factorial', 'hint' => 'Pattern: multiply and decrement', 'difficulty' => 'Hard', 'points' => 100]
];
$submitted = $_SERVER['REQUEST_METHOD'] === 'POST';
$result = null;
if ($submitted) {
    $cid = (int)$_POST['challenge_id'];
    $ans = strtolower(trim($_POST['answer']));
    foreach ($challenges as $c) {
        if ($c['id'] === $cid) {
            $result = ['correct' => strpos($ans, strtolower($c['answer'])) !== false, 'challenge' => $c];
            break;
        }
    }
}
?><!DOCTYPE html><html><head><meta charset="UTF-8"><title>Reverse Engineering - HackToLive CTF</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:monospace;background:linear-gradient(135deg,#0d1f3c 0%,#1a2e5c 50%,#2a5298 100%);min-height:100vh}header{background:rgba(0,0,0,0.95);color:white;padding:30px;text-align:center;border-bottom:3px solid #00ff00}header h1{font-size:2.5em;text-shadow:0 0 20px #00ff00}.container{max-width:1000px;margin:40px auto;padding:20px}.back-btn{display:inline-block;margin-bottom:20px;padding:10px 20px;background:#00ff00;color:#000;border-radius:4px;text-decoration:none;font-weight:bold}.challenge-box{background:#fff;border-radius:8px;padding:25px;margin-bottom:20px;box-shadow:0 4px 15px rgba(0,0,0,0.2);border:1px solid rgba(0,255,0,0.2)}.challenge-box h3{color:#1e3c72;margin-bottom:10px}.badge{display:inline-block;padding:5px 12px;border-radius:4px;font-weight:bold;font-size:0.85em}.points{background:#6c5ce7;color:white;margin-left:10px}.difficulty-hard{background:#FF6B6B;color:white}.difficulty-medium{background:#FFD700}.difficulty-easy{background:#90EE90}.encrypted-text{background:#1a1a1a;color:#00ff00;padding:15px;margin:15px 0;border-left:3px solid #00ff00;border-radius:4px;word-break:break-all}input{width:100%;padding:12px;border:2px solid #00ff00;border-radius:4px;margin:10px 0}.btn{background:#00ff00;color:#000;padding:12px 25px;border:none;border-radius:4px;cursor:pointer;font-weight:bold}.success{background:#d4edda;color:#155724;padding:15px;border-radius:4px;margin-top:15px}.error{background:#f8d7da;color:#721c24;padding:15px;border-radius:4px;margin-top:15px}.hint{background:#fff3cd;color:#856404;padding:12px;border-left:4px solid #ffc107;margin-top:12px}</style></head><body><header><h1>ðŸ”¬ Reverse Engineering</h1><p>Analyze and understand code</p></header><div class="container"><a href="../index.html" class="back-btn">&larr; Back</a><?php foreach($challenges as $c):?><div class="challenge-box"><h3><?=$c['title']?></h3><span class="badge difficulty-<?=strtolower($c['difficulty'])?>"><?=$c['difficulty']?></span><span class="badge points">+<?=$c['points']?> pts</span><p style="margin-top:10px"><?=$c['description']?></p><div class="encrypted-text"><?=$c['encrypted']?></div><?php if($submitted&&$result&&$result['challenge']['id']===$c['id']):?><div class="<?=$result['correct']?'success':'error'?>"> <?=$result['correct']?'âœ… CORRECT! +'.$result['challenge']['points'].' pts':'âŒ Incorrect'?></div><?php endif;?><form method="POST"><input type="text" name="answer" placeholder="Your answer..." required><input type="hidden" name="challenge_id" value="<?=$c['id']?>"><button class="btn">Submit</button></form><div class="hint">ðŸ’¡ <?=$c['hint']?></div></div><?php endforeach;?></div></body></html>